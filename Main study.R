
### DEEP Q #####################################################################
# Winning: ###
win_rate <- c(0.95, 0.951, 0.943, 0.941, 0.931, 0.938, 0.946, 0.936, 0.957, 0.946, 
              0.932, 0.92, 0.902, 0.947, 0.941, 0.917, 0.948, 0.95, 0.936, 0.934, 
              0.943, 0.932, 0.93, 0.955, 0.897, 0.947, 0.941, 0.964, 0.937, 0.941, 
              0.948, 0.922, 0.949, 0.923, 0.932, 0.94, 0.942, 0.899, 0.941, 0.926, 
              0.939, 0.937, 0.951, 0.946, 0.93, 0.937, 0.931, 0.927, 0.952, 0.955, 
              0.942, 0.922, 0.911)
n <- length(win_rate) # = 53
mean(win_rate) # = 0.9368868

# 99% konfidens interval for win rate:
mean(win_rate) + c(-1,1) * qnorm(0.995) * sd(win_rate) / sqrt(n) # = [0.932 , 0.942]


# Scores: ###
scores <- c(80.24575424575424, 79.88611388611389, 78.13186813186813, 78.96003996003996, 
            76.12987012987013, 77.11788211788212, 79.4905094905095, 78.03596403596404, 
            82.12387612387613, 78.4975024975025, 76.89010989010988, 73.24575424575424, 
            70.36363636363636, 80.06493506493507, 77.4065934065934, 74.43556443556443, 
            79.11688311688312, 80.48651348651349, 76.8991008991009, 76.25674325674326, 
            79.06893106893106, 75.1968031968032, 74.51948051948052, 81.57642357642358, 
            70.08691308691309, 80.33466533466533, 78.8991008991009, 82.991008991009, 
            78.02397602397602, 77.48351648351648, 79.54945054945055, 74.9080919080919, 
            80.13686313686314, 74.41158841158841, 75.14985014985015, 78.96103896103897, 
            78.34865134865134, 70.83216783216783, 78.95004995004994, 75.97102897102897, 
            78.25374625374626, 77.86913086913087, 80.10689310689311, 77.991008991009, 
            76.18081918081919, 77.34365634365635, 76.31168831168831, 74.5004995004995, 
            80.43056943056943, 80.28371628371629, 78.89010989010988, 73.66133866133866, 
            70.85714285714286)
n <- length(scores) # = 53
mean(scores) # = 77.39368

# 99% konfidens interval for scores:
mean(scores) + c(-1,1) * qnorm(0.995) * sd(scores) / sqrt(n) # = [76.349 , 78.438]





### Tabular Q ##################################################################
# Winning: ###
win_rate2 <- c(0.072, 0.067, 0.095, 0.081, 0.085, 0.073, 0.091, 0.088, 0.093, 0.069, 
               0.07, 0.07, 0.075, 0.082, 0.097, 0.071, 0.069, 0.082, 0.088, 0.087, 
               0.08, 0.086, 0.079, 0.078, 0.085, 0.081, 0.076, 0.08)

n2 <- length(win_rate2) # = 28
mean(win_rate2) # = 0.08036

# 99% konfidens interval for win rate:
mean(win_rate2) + c(-1,1) * qnorm(0.995) * sd(win_rate2) / sqrt(n2) # = [0.076 , 0.084]


# Scores: ###
scores2 <- c(-117.509, -117.862, -115.205, -117.775, -116.343, -118.092, -115.702, 
             -116.918, -115.383, -119.561, -119.603, -118.576, -117.945, -117.108, 
             -113.511, -118.804, -118.974, -117.927, -117.257, -117.333, -117.559, 
             -116.918, -118.78, -117.313, -115.45, -116.075, -115.379, -117.487)

length(scores2) # = 28
mean(scores2) # = -117.9025

# 99% konfidens interval for scores:
mean(scores2) + c(-1,1) * qnorm(0.995) * sd(scores2) / sqrt(n2) # = [-117.93 , -116.53]





### Plots ######################################################################
boxplot(win_rate2,win_rate,col = c("red","blue"))

boxplot(scores2,scores,col = c("red","blue"))

# Win rate:
perc1 <- win_rate*100
perc2 <- win_rate2*100
plot(perc2,main = "Win rate",xlab = "Episode", ylab = "Percent won",ylim = c(0,115),col = "red")
points(perc1,pch=0,col = "blue")
grid()
legend("topleft",legend = c("Tab Q-learning","Deep Q-learning"),pch = c(1,0),col = c("red","blue"))

# Scores:
plot(scores2,main = "Game score",xlab = "Episode", ylab = "Game score (final 1000 games in each episode)",ylim = c(-150,125),col = "red")
points(scores,pch=0,col = "blue")
grid()
legend("topleft",legend = c("Tab Q-learning","Deep Q-learning"),pch = c(1,0),col = c("red","blue"))


# Learning graph win rate:
xaxis <- seq(100,10000,100)

deeplearnwin <- c(0.0, 18.0, 20.0, 25.0, 35.0, 37.0, 53.0, 49.0, 59.0, 60.0, 62.0, 
                  66.0, 71.0, 68.0, 66.0, 77.0, 72.0, 71.0, 81.0, 76.0, 80.0, 80.0, 
                  75.0, 86.0, 77.0, 79.0, 77.0, 73.0, 69.0, 81.0, 78.0, 87.0, 75.0, 
                  72.0, 78.0, 91.0, 88.0, 82.0, 76.0, 92.0, 89.0, 83.0, 79.0, 84.0, 
                  85.0, 78.0, 87.0, 84.0, 80.0, 87.0, 83.0, 82.0, 84.0, 92.0, 87.0, 
                  91.0, 92.0, 81.0, 91.0, 87.0, 90.0, 85.0, 85.0, 90.0, 92.0, 77.0, 
                  86.0, 88.0, 87.0, 89.0, 88.0, 93.0, 97.0, 85.0, 93.0, 88.0, 91.0, 
                  92.0, 92.0, 90.0, 89.0, 91.0, 93.0, 92.0, 88.0, 94.0, 94.0, 93.0, 
                  91.0, 92.0, 92.0, 94.0, 96.0, 95.0, 97.0, 96.0, 93.0, 93.0, 95.0, 
                  97.0)

tablearnwin <- c(0.0, 0.23, 0.29, 0.1, 0.15, 0.14, 0.07, 0.13, 0.09, 0.15, 0.11, 
                 0.06, 0.11, 0.03, 0.06, 0.08, 0.07, 0.11, 0.13, 0.07, 0.06, 0.12, 
                 0.11, 0.01, 0.06, 0.08, 0.08, 0.1, 0.09, 0.07, 0.08, 0.09, 0.14, 
                 0.08, 0.11, 0.06, 0.11, 0.09, 0.01, 0.07, 0.05, 0.04, 0.08, 0.06, 
                 0.05, 0.08, 0.06, 0.07, 0.06, 0.06, 0.12, 0.08, 0.05, 0.04, 0.04, 
                 0.03, 0.12, 0.1, 0.08, 0.04, 0.13, 0.05, 0.1, 0.1, 0.07, 0.06, 0.05, 
                 0.14, 0.12, 0.08, 0.09, 0.08, 0.06, 0.04, 0.11, 0.07, 0.05, 0.12, 
                 0.07, 0.05, 0.08, 0.06, 0.08, 0.07, 0.08, 0.09, 0.07, 0.1, 0.04, 
                 0.11, 0.08, 0.07, 0.06, 0.07, 0.08, 0.07, 0.05, 0.06, 0.11, 0.06) * 100


plot(xaxis,deeplearnwin,col = "blue", main = "Learning curve win rate",xlab = "Game",
     ylab = "Win rate",pch=0,cex.main = 2, cex.lab = 1.5,ylim = c(0,120))
points(xaxis,tablearnwin,col = "red")
grid()
legend("topleft",legend = c("Tab Q-learning","Deep Q-learning"),pch = c(1,0),col = c("red","blue"),cex = 1.5)

# Learning curve score:


deeplearnscore <- c(-108.0, -96.13, -86.35, -71.28, -49.41, -43.33, -11.43, -17.45, 
                    3.3, 5.6, 10.71, 19.8, 29.42, 24.11, 20.88, 43.65, 33.35, 31.33, 
                    52.27, 42.53, 51.39, 50.75, 41.69, 63.67, 45.9, 49.68, 44.45, 
                    37.16, 29.45, 53.83, 47.03, 65.21, 41.46, 35.77, 48.09, 72.9, 
                    66.72, 52.49, 43.26, 75.82, 66.88, 55.62, 46.45, 56.02, 60.63, 
                    44.33, 63.88, 58.94, 51.51, 63.62, 53.1, 52.8, 58.27, 74.93, 
                    64.46, 73.24, 71.06, 51.95, 72.83, 64.22, 71.03, 59.89, 60.82, 
                    69.62, 75.83, 45.15, 63.44, 66.08, 63.08, 68.46, 59.42, 75.35, 
                    82.69, 59.71, 73.05, 62.96, 72.71, 73.22, 74.26, 70.55, 62.9, 
                    72.13, 75.62, 74.43, 65.43, 77.19, 78.19, 75.98, 65.48, 73.1, 
                    74.07, 79.17, 82.55, 79.63, 83.92, 82.51, 75.15, 75.57, 80.44, 
                    84.41)

tablearnscore <- c(-128.0, -104.23, -87.55, -118.26, -107.5, -113.48, -117.74, -111.47, 
                   -115.11, -113.38, -113.18, -122.3, -113.14, -126.19, -121.99, 
                   -117.35, -117.57, -108.8, -111.99, -123.63, -119.47, -108.26, 
                   -113.34, -128.65, -119.78, -114.14, -119.78, -119.01, -116.69, 
                   -119.5, -116.74, -111.5, -104.48, -114.05, -116.37, -117.96, 
                   -114.05, -115.16, -127.68, -116.93, -120.51, -130.8, -117.29, 
                   -121.04, -121.5, -113.56, -118.84, -122.23, -114.69, -123.84, 
                   -110.28, -120.87, -122.23, -121.25, -122.15, -128.2, -106.32, 
                   -118.13, -114.28, -122.68, -113.27, -124.62, -106.55, -113.49, 
                   -115.47, -125.14, -123.33, -110.34, -105.28, -117.67, -119.14, 
                   -122.79, -116.44, -125.07, -110.41, -120.52, -121.01, -112.69, 
                   -114.92, -124.12, -114.67, -118.55, -116.91, -123.05, -116.86, 
                   -116.02, -119.46, -113.58, -124.18, -114.83, -116.49, -119.65, 
                   -117.11, -114.76, -116.59, -121.88, -119.62, -119.94, -110.35, 
                   -121.65)




plot(xaxis,deeplearnscore,pch=0,col = "blue", main = "Learning curve score", xlab = "Game",
     ylab = "Score", ylim = c(-150,125),cex.main = 2, cex.lab = 1.5)
points(xaxis,tablearnscore,col = "red")
grid()
legend("topleft",legend = c("Tab Q-learning","Deep Q-learning"),pch = c(1,0),col = c("red","blue"),cex = 1.5)


# Learning curve steps:
tablearnstep <- c(53.0, 51.42, 43.95, 54.03, 38.17, 37.23, 42.16, 32.89, 35.12, 
                  34.29, 36.46, 27.92, 35.85, 31.0, 35.77, 37.61, 35.38, 37.04, 
                  31.72, 36.99, 33.43, 37.77, 39.32, 30.96, 28.28, 35.79, 33.34, 
                  31.64, 34.31, 35.38, 34.08, 39.44, 36.01, 31.08, 32.55, 32.88, 
                  35.21, 36.49, 36.38, 39.17, 35.86, 31.97, 36.45, 38.26, 36.32, 
                  42.06, 35.91, 32.0, 33.88, 38.52, 36.27, 36.5, 30.58, 35.74, 
                  35.15, 30.42, 34.14, 31.39, 31.78, 32.93, 33.4, 33.18, 30.39, 
                  30.63, 37.56, 34.84, 35.82, 33.13, 27.31, 32.89, 29.82, 30.66, 
                  28.98, 29.19, 31.22, 34.73, 32.22, 31.22, 29.46, 36.59, 35.98, 
                  29.77, 35.71, 33.1, 31.74, 33.41, 31.81, 32.65, 34.37, 35.03, 
                  32.96, 36.64, 32.32, 34.63, 33.61, 34.23, 31.59, 29.47, 37.78, 
                  42.69)
deeplearnstep <- c(9.0, 33.13, 27.35, 22.28, 20.41, 18.33, 18.43, 16.45, 15.7, 15.4, 
                   14.29, 13.2, 13.58, 12.89, 12.12, 11.35, 11.65, 11.67, 10.73, 
                   10.47, 9.61, 10.25, 9.31, 9.33, 9.1, 9.32, 10.55, 9.84, 9.55, 
                   9.17, 9.97, 9.79, 9.54, 9.23, 8.91, 10.1, 10.28, 12.51, 9.74, 
                   9.18, 12.12, 11.38, 12.55, 12.98, 10.37, 12.67, 11.12, 10.06, 
                   9.49, 11.38, 13.9, 12.2, 10.73, 10.07, 10.54, 9.76, 13.94, 11.05, 
                   10.17, 10.78, 9.97, 11.11, 10.18, 11.38, 9.17, 9.85, 9.56, 10.92, 
                   11.92, 10.54, 17.58, 11.65, 12.31, 11.29, 13.95, 14.04, 10.29, 
                   11.78, 10.74, 10.45, 16.1, 10.87, 11.38, 10.57, 11.57, 11.81, 
                   10.81, 11.02, 17.52, 11.9, 10.93, 9.83, 10.45, 11.37, 11.08, 
                   10.49, 11.85, 11.43, 10.56, 10.59)

plot(xaxis,deeplearnstep,col = "blue", main = "Learning curve steps",xlab = "Game",
     ylab = "steps",pch=0,cex.main = 2, cex.lab = 1.5,ylim = c(0,70))
points(xaxis,tablearnstep,col = "red")
grid()
legend("topleft",legend = c("Tab Q-learning","Deep Q-learning"),pch = c(1,0),col = c("red","blue"),cex = 1.5)


# t.test win rate: ###
t.test(win_rate2,win_rate) # p-value = 2.2e-16

# t.test scores: ###
t.test(scores2,scores) # p-value = 2.2e-16






















